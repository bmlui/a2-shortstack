<!doctype html>
<html lang="en">
  <head>
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
    <script src="js/main.js"></script>
    <link rel="stylesheet" href="css/main.css">
    

    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  </head>
  <body>


    <h1>Results</h1>
   
    <table >
      <thead>
        <tr>
          <th>Name</th>
        </tr>
      </thead>
      <tbody id="results">
        <tr></tr>

      </tbody>
    </table>
    <script>
      //get data from /api/getdata
      fetch('/api/getdata')
        .then(response => response.json())
        .then(data => {
          let results = document.getElementById('results');
          data.forEach(row => {
            let tr = document.createElement('tr');
            let td = document.createElement('td');
            td.textContent = row.name;
            tr.appendChild(td);
            let td2 = document.createElement('td');
            // add delete link
           let a = document.createElement('a');
            a.href = '#';
            a.textContent = 'delete';
            td2.appendChild(a);
            td2.onclick = function() {
              fetch('/api/delete', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({row})
              })
              .then(response => response.json())
              .then(data => {
                if (data.success) {
                  tr.remove();
                }
              });
            };
            tr.appendChild(td2);
            
            let td3 = document.createElement('td');
            let a2 = document.createElement('a');
            a2.href = '#';
            a2.textContent = 'edit';
            td3.appendChild(a2);
            td3.onclick = function() {
              let newName = prompt('Enter a new name');
              if (!newName) {
                return;
              }
              row.newName = newName;
            
              fetch('/api/edit', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({row})
              })
              .then(response => response.json())
              .then(data => {
                if (data.success) {
                  td.textContent = newName;
                }
              });
            };
            tr.appendChild(td3);

            results.appendChild(tr);
          });
        });
    </script>
  </body>
 

</html>
